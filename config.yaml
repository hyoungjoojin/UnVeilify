name: NoMask

logger:
  path: "logs"
  verbosity: 2

train_dataloader:
  name: MaskPairImageDataLoader
  args:
    masked_image_dir: './data/processed/masked_image'
    identity_image_dir: './data/processed/identity_image'
    unmasked_image_dir: './data/processed/unmasked_image'
    batch_size: 16
    shuffle: True,
    num_workers: 2

validation_dataloader:
  name: MaskPairImageDataLoader
  args:
    masked_image_dir: './data/processed/masked_image'
    identity_image_dir: './data/processed/identity_image'
    unmasked_image_dir: './data/processed/unmasked_image'
    batch_size: 2 
    shuffle: True,
    num_workers: 2

model:
  generator:
    name: MaskRemover 
    args:
      output_resolution: 512
      latent_dim: 512
  discriminator:
    name: Discriminator

loss:
  name: MaskRemoverLoss
  args:
    lambda_content: 1.0
    lambda_perceptual: 0.8
    lambda_identity: 0.1
    lambda_adversarial: 0.5

optimizer:
  optim_g:
    name: Adam
    args:
      lr: !!float 3e-4
      eps: !!float 1e-8
      betas: [0.9, 0.99]

  optim_d:
    name: Adam
    args:
      lr: !!float 3e-4
      eps: !!float 1e-8
      betas: [0.9, 0.99]

lr_scheduler:
  name: MultiStepLR
  args:
    milestones: [80000, 120000, 160000, 200000]
    gamma: 0.5

trainer:
  num_epochs: 100
  log_step: 5

  checkpoint_dir: "experiments/"
  save_period: 1

  monitor: "min_val_loss"
  early_stop: 10

  use_tensorboard: True

  validation:
    do_validation: True
    validation_steps: 5

